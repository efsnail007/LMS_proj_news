{% extends 'base/base.html' %}

{% block title %} {{ item.title }} {% endblock %}

{% block content %}


        <h2> {{ item.title }} </h2>
        <h6>Автор: {{ item.author }}</h6>
        <p> Дата публикации: {{ item.created_at }} </p>
        <br/>
        <p> {{ item.text }} </p>
        <div>
            {% if item.author == user %}
                <p><a href="{% url 'item:update_item' item_id=item.id  %}">Редактировать новость</a></p>

                <!-- Кнопка удаления задачи -->
                <p><a href="{% url 'item:delete_item' item_id=item.id  %}"onclick="return confirm('Вы уверены, что хотите удалить эту новость?');">Удалить новость</a></p>
            {% endif %}
            
 
                <!-- Оставить жалобу -->
            <p><a href="{% url 'item:feedback' item_id=item.id  %}">Оставить жалобу</a></p>

        </div>
        <div>
            <br/>
            <form action="{% url 'item:add_likes' item_id=item.id %}" method="post">
                {% csrf_token %}
                {% if item.author == user %} 
                    {% if liked %}
                    <button type="submit", name="item_id", value="{{ item_id }}", class="btn btn-primary btn-sm">Убрать лайк</button>
                    {% else %}
                    <button type="submit", name="item_id", value="{{ item_id }}", class="btn btn-primary btn-sm">Лайк</button>
                    {% endif %}
                    - {{ total_likes }} 
                {% endif %}
            </form>
        </div>
        <br/>
        <div class="form-comment">
            <h3>Комментарии</h3>
            <br/>
            <div>
                    <form action="{% url 'item:add_comment' item_id=item.id %}" method="post">
                        {% csrf_token %}
                        <label>Ваш комментарий</label>
                        <textarea name="text"></textarea>
                        <button type="submit">Отправить</button>
                        <br/>
                        {% if not item.comments.all %}
                            <br/> Нет комментариев
                        {% else %}
                            {% for comment in item.comments.all %}
                                <strong>
                                    <br/>
                                    <img src="{{ comment.author.profile.photo }}" width="100" height="100">
                                    <a href="{{ comment.author.profile.user }}">{{ comment.author }}</a> 
                                    - {{ comment.created_at }}
                                </strong>
                                <p>{{ comment.text }}</p>
                            {% endfor %}
                        {% endif %}
                    </form>
            </div>


        </div>

{% endblock %}